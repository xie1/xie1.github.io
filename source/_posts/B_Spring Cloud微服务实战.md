---
title: Spring Cloud微服务实战
date: 2019-11-16 10:17:59
tags: 
categories: 
---
#一、*思维导图*
#*总知识点*
###1、基本知识
	1、微服务架构
	2、Spring Could
		Spring Could是一个基于Spring boot实现的微服务架构开发工具，它为微服务架构中涉及的配置管理、服务治理、断路器、智能路由、微代理、控制总线、全局锁、决策竞选、分布式会话和集群状态管理等操作提供了一种简单的开发方式
![Alt text](./1565961147752.png)
![Alt text](./1565961179422.png)
###2、微服务构建：Spring Boot
###3、服务治理：Spring Cloud Eureka
####3.1、服务治理
		服务治理可以说是微服务架构中最为核心和基础的模块，它主要用来实现各个微服务实例的自动化注册与发现。
		1、服务注册
		2、服务发现
####3.2、Netflix Eureka
		1、Eureka服务端，也是我们服务注册中心
		2、Eureka客户端，主要处理服务的注册与发现
			客户端向注册中心注册自身提供的服务并周期性发送心跳来更新它的服务租约。
####3.3、搭建服务注册中心
		1、注册服务提供者
		2、高可用的注册中心
			Eureka Server的高可用实际上就是将自己作为服务向其他服务注册中心注册自己，这样就可以形成一组相互注册的服务注册中心，以实现服务清单的互相同步，达到高可用的效果。
![Alt text](./1566044611288.png)
![Alt text](./1566044624721.png)
####3.4、服务发现与消费
	1、发现服务
		服务发现的任务有Eureka的客户端完成
	2、消费服务
		服务消费任务由Ribbon完成，Ribbon是一个基于HTTP和TCP的客户端负载均衡器，它可以在通过客户端中配置的ribbonServerList服务端列表去轮询访问已达到负载均衡器的作用
####3.5、Eureka详解
	1、基础架构：
		构建了Euraka服务治理体系：
		1、服务注册中心
		2、服务提供者
		3、服务消费者
	2、服务治理机制
![Alt text](./1566046772188.png)
![Alt text](./1566046785165.png)
![Alt text](./1566046894174.png)
![Alt text](./1566046902930.png)
![Alt text](./1566046987749.png)
![Alt text](./1566047113107.png)
#####3.5.1、源码分析——》暂未学习
	从Eureka的客户端作为入口看它是如何完成这些主动通信行为
![Alt text](./1566047547081.png)

Eureka Client 负责下面的任务：
1、向Eureka Server 注册服务实例
2、向Eureka Server 服务租约
3、当服务关闭期间，向Eureka Server取消租约
4、查询Eureka Server中的服务实例列表
5、Eureka Client 还需要配置一个Eureka Server的URL列表

####3.6、配置详解
	服务端为服务注册中心，而客户端为各个提供接口的微服务应用
	Eureka客户端的配置主要分为：
	1、服务注册相关的配置信息，包括服务注册中心的地址、服务获取的间隔时间、可用区域等
	2、服务实例相关的配置信息，包括服务实例的名称、IP地址、端口号、健康检查路径
		1、元数据
			用来描述吱声服务信息的对象，其中包含了一些标准化的元数据，比如服务名称等
		2、实例名称配置
			利用应用名加随机数的方式来区分不同的实例
		3、端点配置
		4、健康检测

###4、客户端负载均衡：Spring Cloud Ribbon——》至
####4.1、客户端负载均衡
	负载均衡都是指服务端的负载均衡，其中分为硬件负载均衡和软件负载均衡。
	1、硬件负载均衡主要通过在服务器节点之间安装专门用于负载均衡的设备。比如F5
	2、软件负载均衡则是通过在服务器上安装一些具有均衡负载功能或者模块的软件来完成请求分发工作，例如nginx
![Alt text](./1566999034764.png)

客户端的负载均衡:所有客户端节点都维护着自己要访问的服务端清单，而这些服务端的清单来自于服务注册中心
调用：
	1、服务提供者只需要启动多个服务实例并注册到一个注册中心
	2、服务消费者直接通过调用被@LoadBalanced注解修饰过的RestTemplate来实现面向服务的接口调用

####4.2、RestTemplate详解
	对于get\Post请求的实现
	1、getForEntity
####4.3、源码分析——》未分析
	Ribbon是如何通过RestTemplate实现客户端负载均衡的。




###5、服务容错保护：Spring Cloud Hystrix
	实现了断路器、线程隔离等一系列服务保护功能、该框架的目标是在于通过控制那些访问远程系统、服务和第三方库的节点。从而对延迟和故障提供更强大的容错能力。Hystrix具备服务降级、服务熔断、线程和信号隔离、请求缓存、请求合并以及服务监控等强大功能
![Alt text](./1571557497276.png)

###6、声明式服务调用：Spring Cloud Feign